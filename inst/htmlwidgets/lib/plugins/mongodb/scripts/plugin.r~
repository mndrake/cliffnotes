`_tam_queryMongoDB` <- function(host, port, database, collection, username, password, query = "{}", isFlatten){
  library(mongolite)
  require(stringr)
  # read stored password
  pass = `_tam_saveOrReadPassword`("mongodb", username, password)
  con <- mongo(collection, url = str_c("mongodb://", username, ":", pass, "@", host, ":", as.character(port), "/", database))
  data <- con$find(query = query)
  result <-data
  if(isFlatten){
    result <- flatten(data)    
  }
  if(nrow(result)==0){
    stop("No Data Found");
  } else {
    result
  }
  
}
